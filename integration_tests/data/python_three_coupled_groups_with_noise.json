{
  "id": "py_three_coupled_groups_with_noise",
  "language": "python",
  "name": "Python: 3 coupled feature groups + noise docs â€” 8 files, 13 hunks",
  "description": "Three independent features, each requiring source+test co-location, interleaved with 2 independent doc-only files. Feature A: auth/token.py renames verify_token() to validate_token() + auth/test_token.py updates calls. Feature B: db/models.py removes deprecated field + db/test_models.py removes assertion. Feature C: api/views.py changes return type + api/serializers.py updates serialization. Docs: README.md and CHANGELOG.md are independent. The LLM is tempted to group by type (all source, all tests, all docs) which breaks 3 constraints.",
  "difficulty": "super_hard",
  "category": "multi_coupled_groups_with_noise",
  "num_files": 8,
  "num_hunks": 13,
  "file_diffs": [
    {
      "file_path": "auth/token.py",
      "hunks": [
        {
          "id": "H1_sh01a1",
          "header": "@@ -20,7 +20,7 @@",
          "lines": [
            "-def verify_token(token: str) -> dict:",
            "+def validate_token(token: str) -> dict:",
            "     \"\"\"Validate a JWT token and return claims.\"\"\"",
            "     return jwt.decode(token, SECRET, algorithms=['HS256'])"
          ]
        },
        {
          "id": "H2_sh01a2",
          "header": "@@ -40,7 +40,7 @@",
          "lines": [
            " def get_current_user(request):",
            "     token = request.headers.get('Authorization')",
            "-    claims = verify_token(token)",
            "+    claims = validate_token(token)",
            "     return User.query.get(claims['user_id'])"
          ]
        }
      ]
    },
    {
      "file_path": "db/models.py",
      "hunks": [
        {
          "id": "H3_sh01b3",
          "header": "@@ -15,8 +15,6 @@",
          "lines": [
            " class User(Base):",
            "     id = Column(Integer, primary_key=True)",
            "     email = Column(String, unique=True)",
            "-    legacy_role = Column(String, default='user')  # deprecated",
            "     role = Column(String, default='user')"
          ]
        }
      ]
    },
    {
      "file_path": "api/views.py",
      "hunks": [
        {
          "id": "H4_sh01c4",
          "header": "@@ -30,8 +30,10 @@",
          "lines": [
            " @app.get('/users/{user_id}')",
            " def get_user(user_id: int):",
            "     user = User.query.get(user_id)",
            "-    return {'id': user.id, 'email': user.email}",
            "+    return UserResponse(",
            "+        id=user.id, email=user.email, role=user.role",
            "+    ).dict()"
          ]
        }
      ]
    },
    {
      "file_path": "api/serializers.py",
      "hunks": [
        {
          "id": "H5_sh01c5",
          "header": "@@ -5,6 +5,7 @@",
          "lines": [
            " class UserResponse(BaseModel):",
            "     id: int",
            "     email: str",
            "+    role: str"
          ]
        }
      ]
    },
    {
      "file_path": "README.md",
      "hunks": [
        {
          "id": "H6_sh01d6",
          "header": "@@ -10,7 +10,7 @@",
          "lines": [
            " ## Authentication",
            " ",
            "-Use `verify_token()` to validate JWT tokens.",
            "+Use `validate_token()` to validate JWT tokens.",
            " See the API docs for details."
          ]
        },
        {
          "id": "H7_sh01d7",
          "header": "@@ -25,6 +25,8 @@",
          "lines": [
            " ## API Endpoints",
            " ",
            "+The user endpoint now returns the `role` field.",
            "+",
            " ### GET /users/{id}"
          ]
        }
      ]
    },
    {
      "file_path": "CHANGELOG.md",
      "hunks": [
        {
          "id": "H8_sh01e8",
          "header": "@@ -1,6 +1,12 @@",
          "lines": [
            " # Changelog",
            " ",
            "+## 2.1.0",
            "+- Renamed verify_token to validate_token",
            "+- Removed deprecated legacy_role field",
            "+- Added role to user API response",
            "+",
            " ## 2.0.0"
          ]
        }
      ]
    },
    {
      "file_path": "tests/test_token.py",
      "hunks": [
        {
          "id": "H9_sh01f9",
          "header": "@@ -3,7 +3,7 @@",
          "lines": [
            "-from auth.token import verify_token",
            "+from auth.token import validate_token"
          ]
        },
        {
          "id": "H10_sh01fa",
          "header": "@@ -15,7 +15,7 @@",
          "lines": [
            " def test_valid_token():",
            "     token = create_test_token({'user_id': 1})",
            "-    claims = verify_token(token)",
            "+    claims = validate_token(token)",
            "     assert claims['user_id'] == 1"
          ]
        },
        {
          "id": "H11_sh01fb",
          "header": "@@ -28,7 +28,7 @@",
          "lines": [
            " def test_expired_token():",
            "     token = create_expired_token()",
            "     with pytest.raises(jwt.ExpiredSignatureError):",
            "-        verify_token(token)",
            "+        validate_token(token)"
          ]
        }
      ]
    },
    {
      "file_path": "tests/test_models.py",
      "hunks": [
        {
          "id": "H12_sh01gc",
          "header": "@@ -20,8 +20,6 @@",
          "lines": [
            " def test_user_defaults():",
            "     user = User(email='a@b.c')",
            "-    assert user.legacy_role == 'user'",
            "     assert user.role == 'user'"
          ]
        },
        {
          "id": "H13_sh01gd",
          "header": "@@ -35,7 +33,6 @@",
          "lines": [
            " def test_user_columns():",
            "     cols = [c.name for c in User.__table__.columns]",
            "-    assert 'legacy_role' in cols",
            "     assert 'role' in cols"
          ]
        }
      ]
    }
  ],
  "file_relationships": [
    {"source": "tests/test_token.py", "target": "auth/token.py", "kind": "direct"},
    {"source": "tests/test_models.py", "target": "db/models.py", "kind": "direct"},
    {"source": "api/views.py", "target": "api/serializers.py", "kind": "direct"},
    {"source": "api/views.py", "target": "db/models.py", "kind": "direct"}
  ],
  "must_be_together": [
    ["auth/token.py", "tests/test_token.py"],
    ["db/models.py", "tests/test_models.py"],
    ["api/views.py", "api/serializers.py"]
  ],
  "must_be_ordered": [],
  "hunk_to_file": {
    "H1_sh01a1": "auth/token.py",
    "H2_sh01a2": "auth/token.py",
    "H3_sh01b3": "db/models.py",
    "H4_sh01c4": "api/views.py",
    "H5_sh01c5": "api/serializers.py",
    "H6_sh01d6": "README.md",
    "H7_sh01d7": "README.md",
    "H8_sh01e8": "CHANGELOG.md",
    "H9_sh01f9": "tests/test_token.py",
    "H10_sh01fa": "tests/test_token.py",
    "H11_sh01fb": "tests/test_token.py",
    "H12_sh01gc": "tests/test_models.py",
    "H13_sh01gd": "tests/test_models.py"
  }
}

