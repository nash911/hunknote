{
  "id": "ts_two_coupled_pairs_interleaved",
  "language": "typescript",
  "name": "TypeScript: 4 files â€” two coupled pairs interleaved",
  "description": "Feature A: order.ts adds 'discount' field, billing.ts uses it. Feature B: logger.ts adds AUDIT log level, errorHandler.ts uses it. Features are independent but interleaved. LLM should create 2 commits (one per feature), not 4.",
  "difficulty": "hard",
  "category": "independent_features_interleaved",
  "num_files": 4,
  "num_hunks": 4,
  "file_diffs": [
    {
      "file_path": "src/models/order.ts",
      "hunks": [
        {
          "id": "H1_cp01a1",
          "header": "@@ -3,6 +3,7 @@",
          "lines": [
            " export interface Order {",
            "   id: string;",
            "   items: OrderItem[];",
            "   total: number;",
            "+  discount: number;",
            " }"
          ]
        }
      ]
    },
    {
      "file_path": "src/utils/logger.ts",
      "hunks": [
        {
          "id": "H2_cp01b2",
          "header": "@@ -5,6 +5,7 @@",
          "lines": [
            " export enum LogLevel {",
            "   DEBUG = 'debug',",
            "   INFO = 'info',",
            "   WARN = 'warn',",
            "+  AUDIT = 'audit',",
            "   ERROR = 'error',",
            " }"
          ]
        }
      ]
    },
    {
      "file_path": "src/services/billing.ts",
      "hunks": [
        {
          "id": "H3_cp01c3",
          "header": "@@ -15,7 +15,8 @@",
          "lines": [
            " export function calculateTotal(order: Order): number {",
            "   const subtotal = order.items.reduce((sum, item) => sum + item.price, 0);",
            "-  return subtotal;",
            "+  const discounted = subtotal * (1 - order.discount);",
            "+  return Math.max(0, discounted);",
            " }"
          ]
        }
      ]
    },
    {
      "file_path": "src/middleware/errorHandler.ts",
      "hunks": [
        {
          "id": "H4_cp01d4",
          "header": "@@ -8,6 +8,9 @@",
          "lines": [
            " export function handleError(err: Error, req: Request, res: Response) {",
            "   logger.log(LogLevel.ERROR, err.message);",
            "+  if (err instanceof AuthorizationError) {",
            "+    logger.log(LogLevel.AUDIT, `Auth failure: ${req.path}`);",
            "+  }",
            "   res.status(500).json({ error: 'Internal server error' });",
            " }"
          ]
        }
      ]
    }
  ],
  "file_relationships": [
    {"source": "src/services/billing.ts", "target": "src/models/order.ts", "kind": "direct"},
    {"source": "src/middleware/errorHandler.ts", "target": "src/utils/logger.ts", "kind": "direct"}
  ],
  "must_be_together": [
    ["src/models/order.ts", "src/services/billing.ts"],
    ["src/utils/logger.ts", "src/middleware/errorHandler.ts"]
  ],
  "hunk_to_file": {
    "H1_cp01a1": "src/models/order.ts",
    "H2_cp01b2": "src/utils/logger.ts",
    "H3_cp01c3": "src/services/billing.ts",
    "H4_cp01d4": "src/middleware/errorHandler.ts"
  }
}

